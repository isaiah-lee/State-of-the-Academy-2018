function generateTooltip(e){return"<h4>"+e.title+"</h4><p>Responses: <strong>"+e.responses+"</strong><br>Percentage: <strong>"+(100*e.percentage).toFixed(1)+"%</strong></p>"}d3.selectAll(".map").each(function(){var e,t=0,s=["Discontinuous","Northeast","Southeast","Southwest","West","Midwest","International"],n=this.dataset.responses.split(",").map(function(e,n){return t+=parseInt(e),{responses:parseInt(e),name:s[n]}}),o=this,d=d3.select(this.firstChild);d3.svg(this.dataset.url).then(function(s){var r=s.documentElement;d3.select(o).node().appendChild(r),d3.select(r).selectAll("*").data(n).on("mouseover",function(s,n){e=generateTooltip({title:s.name,responses:s.responses,percentage:s.responses/t}),d.classed("hidden",!1).html(e)}).on("mousemove",function(e){var t=d3.mouse(o);d.style("left",t[0]-Math.round(d.node().offsetWidth/2)+"px").style("top",t[1]-Math.round(d.node().offsetHeight)-10+"px")}).on("mouseout",function(e){d.classed("hidden",!0)})})});var percentageSliders=d3.selectAll(".percentage-slider").each(function(){var e=parseInt(this.dataset.yes),t=parseInt(this.dataset.no),s=generateTooltip({title:"Yes",responses:e,percentage:e/(e+t)}),n=generateTooltip({title:"No",responses:t,percentage:t/(e+t)}),o=d3.select(this.firstChild),d=parseInt(d3.select(this.children[1]).node().style.width.replace("%","")),r=parseInt(d3.select(this.children[2]).node().style.width.replace("%",""));d3.select(this.children[1]).on("mouseover",function(e){o.classed("hidden",!1).html(s).style("left","calc("+Math.round(d/2)+"% - "+Math.round(o.node().offsetWidth/2)+"px)").style("top","-"+(Math.round(o.node().offsetHeight)+10)+"px")}).on("mouseout",function(e){o.classed("hidden",!0)}),d3.select(this.children[2]).on("mouseover",function(e){o.classed("hidden",!1).html(n).style("left","calc("+Math.round(d+r/2)+"% - "+Math.round(o.node().offsetWidth/2)+"px)").style("top","-"+(Math.round(o.node().offsetHeight)+10)+"px")}).on("mouseout",function(e){o.classed("hidden",!0)})});